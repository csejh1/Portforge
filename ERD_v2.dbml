// [ENUM ì •ì˜: ê¸°ìˆ  ìŠ¤íƒ ë° ì¹´í…Œê³ ë¦¬]
Enum StackCategory {
  FRONTEND
  BACKEND
  DB
  INFRA
  DESIGN
  ETC
}

Enum TechStack {
  // í”„ë¡ íŠ¸ì—”ë“œ
  React
  Vue
  Nextjs
  Svelte
  Angular
  TypeScript
  JavaScript
  TailwindCSS
  StyledComponents
  Redux
  Recoil
  Vite
  Webpack
  
  // ë°±ì—”ë“œ
  Java
  Spring
  Nodejs
  Nestjs
  Go
  Python
  Django
  Flask
  Express
  php
  Laravel
  GraphQL
  RubyOnRails
  CSharp // C#ì—ì„œ ë³€ê²½
  DotNET // .NETì—ì„œ ë³€ê²½
  
  // DB
  MySQL
  PostgreSQL
  MongoDB
  Redis
  Oracle
  SQLite
  MariaDB
  Cassandra
  DynamoDB
  FirebaseFirestore
  Prisma
  
  // ì¸í”„ë¼
  AWS
  Docker
  Kubernetes
  GCP
  Azure
  Terraform
  Jenkins
  GithubActions
  Nginx
  Linux
  Vercel
  Netlify
  
  // ë””ìžì¸
  Figma
  AdobeXD
  Sketch
  Canva
  Photoshop
  Illustrator
  Blender
  UIUX_Design // UI/UX ë””ìžì¸ì—ì„œ ë³€ê²½
  Branding
  
  // ê¸°íƒ€
  Git
  Slack
  Jira
  Notion
  Discord
  Postman
  Swagger
  Zeplin
}

// [1. Auth Service]
Table users {
  user_id uuid [not null, pk, note: 'ðŸ”‘ PK: Cognitoì˜ sub(Subject ID)']
  email varchar(100) [unique, note: 'ê´€ë¦¬/ê²€ìƒ‰ìš© ì´ë©”ì¼ ìŠ¤ëƒ…ìƒ·']
  nickname varchar(20) [not null]
  role ENUM('USER', 'ADMIN') [default: 'USER']
  profile_image_url text
  liked_project_ids json [note: 'Array: [1, 20, 55]']
  test_count int [default: 5]
  created_at timestamp [default: `now()`]
  updated_at timestamp [note: 'ðŸ“ í”„ë¡œí•„ ìˆ˜ì • ì¼ì‹œ']
}

Table user_stacks {
  stack_id bigint [pk, note: 'ðŸ”‘ PK', increment]
  user_id uuid [not null]
  position_type StackCategory [not null]
  stack_name TechStack [not null]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()` ]
}

// [2. Project Service]
Table projects {
  project_id bigint [pk, increment]
  user_id uuid [not null, note: 'ðŸ”— íŒ€ìž¥ ID']
  type ENUM('PROJECT', 'STUDY') [not null]
  title varchar(100) [not null]
  description text [not null]
  method ENUM('ONLINE', 'OFFLINE', 'MIXED') [default: 'ONLINE']
  status ENUM('RECRUITING', 'PROCEEDING', 'COMPLETED', 'CLOSED') [default: 'RECRUITING']
  start_date date [not null]
  end_date date [not null]
  test_required boolean [default: false]
  views int [default: 0]
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table project_recruitment_positions {
  project_id bigint [pk,not null]
  position_type StackCategory [not null]
  required_stacks TechStack [not null]
  employment_type varchar(20)
  target_count integer
  current_count integer [default: 0]
  recruitment_deadline date
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table applications {
  application_id bigint [pk, increment]
  project_id bigint [not null]
  user_id uuid [not null]
  position_type StackCategory [not null]
  prefer_stacks TechStack
  message text [not null]
  target_count integer
  current_count integer [default: 0]
  status ENUM('PENDING', 'ACCEPTED', 'REJECTED') [default: 'PENDING']
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

// [3. Team Service]
Table teams {
  team_id bigint [pk, increment]
  project_id bigint [unique, not null]
  name varchar(50) [not null]
  s3_key varchar(1024) [not null]
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table team_members {
  team_id bigint [not null]
  user_id uuid [not null]
  role ENUM('LEADER', 'MEMBER') [default: 'MEMBER']
  position_type StackCategory [not null]
  updated_at timestamp [default: `now()`]
  Indexes { (team_id, user_id) [pk] }
}

Table meeting_notes {
  note_id bigint [pk, increment]
  team_id bigint [not null]
  user_id uuid [not null]
  s3_key varchar(1024) [not null]
  created_at timestamp [default: `now()`]
}

// [Enum for New Types]
Enum ReportType {
  MEETING_MINUTES
  PROJECT_PLAN // ê¸°íšì„œ
  WEEKLY_REPORT
  PORTFOLIO // í¬íŠ¸í´ë¦¬ì˜¤ (ì¼ë°˜ ë¦¬í¬íŠ¸ í˜•íƒœì¼ ê²½ìš°)
}

Enum TestType {
  PRACTICE // ì—°ìŠµ ëª¨ë“œ (ì˜µì…˜, í˜„ìž¬ ì •ì±…ìƒ ë¯¸ì‚¬ìš©ì´ë‚˜ í™•ìž¥ì„± ê³ ë ¤)
  APPLICATION // ì§€ì› ëª¨ë“œ
}

// [4. AI Service - Revised]

// Table generated_test ì œê±°ë¨ (ì‚¬ìš©ìž ìš”ì²­ ë°˜ì˜: ë¶ˆí•„ìš”)

// ê°œë³„ ë¬¸ì œ ì €ìž¥ì†Œ (ë¬¸ì œì€í–‰)
Table tests {
  test_id bigint [pk, increment]
  stack_name TechStack [not null, note: 'ë¬¸ì œì˜ ì¹´í…Œê³ ë¦¬ (React, Java...)']
  question_json json [not null, note: 'ë‹¨ì¼ ë¬¸ì œ ë°ì´í„° {q, options, answer, explanation}']
  difficulty varchar(20) [default: 'ì´ˆê¸‰']
  source_prompt text [note: 'ìƒì„± ì‹œ ì‚¬ìš©ëœ í”„ë¡¬í”„íŠ¸ (Logìš©)']
  created_at timestamp [default: `now()`]
}

// í…ŒìŠ¤íŠ¸ ì‘ì‹œ ê²°ê³¼ (ì£¼ 3íšŒ ì œí•œ ì²´í¬ìš©)
Table test_results {
  result_id bigint [pk, increment]
  
  user_id uuid [not null]
  
  // ì§€ì› ëª¨ë“œì¼ ë•Œë§Œ ê³µê³ /ì§€ì›ì„œ ID ë§¤í•‘ (Null í—ˆìš©í•˜ì—¬ í™•ìž¥ì„± í™•ë³´)
  project_id bigint
  application_id bigint [unique, note: '1ë²ˆì˜ ì§€ì› = 1ë²ˆì˜ ê²°ê³¼']
  
  type TestType [default: 'APPLICATION']
  
  score int
  feedback text
  created_at timestamp [default: `now()`]
}

// íšŒì˜ ì„¸ì…˜ ê´€ë¦¬ (ì±„íŒ… ë¡œê·¸ êµ¬ê°„ ì¶”ì¶œìš©)
Table meeting_sessions {
  session_id bigint [pk, increment]
  team_id bigint [not null]
  project_id bigint [note: 'DynamoDB ì±„íŒ… ì¡°íšŒìš© íŒŒí‹°ì…˜ í‚¤ êµ¬ì„±']
  start_time timestamp [not null]
  end_time timestamp [note: 'ì¢…ë£Œ ì‹œì  ê¸°ë¡']
  status ENUM('IN_PROGRESS', 'COMPLETED') [default: 'IN_PROGRESS']
  
  // ì´ íšŒì˜ë¥¼ í†µí•´ ìƒì„±ëœ íšŒì˜ë¡ ë¦¬í¬íŠ¸ ì—°ê²°
  generated_report_id bigint
}

// AIê°€ ìƒì„±í•œ ê°ì¢… ë¦¬í¬íŠ¸ (íšŒì˜ë¡, ê¸°íšì„œ ë“±)
Table generated_reports {
  report_id bigint [pk, increment]
  team_id bigint [not null]
  project_id bigint [note: 'í”„ë¡œì íŠ¸ë³„ íšŒì˜ë¡ ì¡°íšŒ ì§€ì›']
  created_by uuid [not null]
  
  report_type varchar(50) [not null, note: 'MEETING_MINUTES, PROJECT_PLAN, WEEKLY_REPORT, PORTFOLIO']
  status ENUM('PENDING', 'COMPLETED', 'FAILED') [default: 'PENDING', note: 'ë¹„ë™ê¸° ìƒì„± ìƒíƒœ ì¶”ì ']
  model_id varchar(100) [note: 'AI ëª¨ë¸ ID ê¸°ë¡ìš©']
  
  title varchar(200) [note: 'OOì›” OOì¼ íšŒì˜ë¡ / OO í”„ë¡œì íŠ¸ ê¸°íšì„œ']
  s3_key varchar(1024) [note: 'S3ì— JSONìœ¼ë¡œ ì €ìž¥ëœ íšŒì˜ë¡ ë‚´ìš© ê²½ë¡œ']
  
  created_at timestamp [default: `now()`]
}

// [ì¶”ê°€] AI ê¸°ë°˜ ìžë™ í¬íŠ¸í´ë¦¬ì˜¤
Table portfolios {
  portfolio_id bigint [pk, increment]
  user_id uuid [not null, note: 'ëˆ„êµ¬ì˜ í¬íŠ¸í´ë¦¬ì˜¤ì¸ê°€']
  project_id bigint [not null, note: 'ì–´ë–¤ í”„ë¡œì íŠ¸ ê²°ê³¼ë¬¼ì¸ê°€']
  
  // AI ìƒì„± í›„ ì‚¬ìš©ìžê°€ ìˆ˜ì • ê°€ëŠ¥í•œ í•„ë“œë“¤
  title varchar(200) [default: 'í”„ë¡œì íŠ¸ íšŒê³ ë¡']
  summary text [note: 'í•œ ì¤„ ìš”ì•½']
  role_description text [note: 'ë‚´ê°€ ë§¡ì€ ì—­í•  ìƒì„¸']
  problem_solving text [note: 'íŠ¸ëŸ¬ë¸” ìŠˆíŒ… ê²½í—˜ (íšŒì˜ë¡ ê¸°ë°˜ ì¶”ì¶œ)']
  tech_stack_usage text [note: 'ì‚¬ìš© ê¸°ìˆ ê³¼ í™œìš© ë°©ì‹']
  growth_point text [note: 'ë°°ìš´ ì  ë° ì„±ìž¥ ìš”ì†Œ']
  
  thumbnail_url varchar(1024)
  is_public boolean [default: true]
  
  created_at timestamp [default: `now()`]
  updated_at timestamp
}


// [5. Support & Comm Service]
Table project_reports {
  report_id bigint [pk, increment]
  user_id uuid [not null, note: 'ðŸ”— FK: ì‹ ê³ ìž(users.user_id)']
  project_id bigint [not null, note: 'ðŸ”— FK: ì‹ ê³  ëŒ€ìƒ í”„ë¡œì íŠ¸(projects.project_id)']
  type ENUM('REPORT', 'INQUIRY', 'BUG') [not null]
  content text [not null]
  status ENUM('PENDING', 'IN_PROGRESS', 'RESOLVED', 'DISMISSED') [default: 'PENDING']
  resolution_note text
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table notifications {
  notification_id bigint [pk, increment]
  user_id uuid [not null]
  message text
  link text
  is_read boolean [default: false]
  created_at timestamp [default: `now()`]
}

Table notices {
  notice_id bigint [pk, increment]
  title varchar(100) [not null]
  content text [not null]
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table banners {
  banner_id bigint [pk, increment]
  title varchar(100)
  link text
  is_active boolean [default: true]
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

Table events {
  event_id bigint [pk, increment]
  title varchar(100)
  category ENUM(ê³µëª¨ì „, í•´ì»¤í†¤)
  event_description text
  image_url text
  event_date timestamp
  created_at timestamp [default: `now()`]
  updated_at timestamp
}

// [DynamoDB Entities]
Table team_chats_ddb {
  project_id bigint [pk, note: 'ðŸ”‘ PK: ROOM#{project_id}']
  timestamp varchar [note: 'MSG#{timestamp}']
  message_id varchar(50)
  user_id uuid
  message text
  created_at timestamp
}

Table chat_rooms_ddb {
  user_id uuid [pk, note: 'ðŸ”‘ PK: USER#{user_id}']
  room_id bigint
  updated_at timestamp
}

// --- TableGroups ---
TableGroup Auth_Service {
  users
  user_stacks
}

TableGroup Project_Service {
  projects
  project_recruitment_positions
  applications
}

TableGroup Team_Service {
  teams
  team_members
}

TableGroup AI_Service {
  tests
  test_results
  meeting_sessions // Added
  generated_reports
  portfolios // Added
  meeting_notes // Legacy(ìˆ˜ë™ ë…¸íŠ¸ìš©)
}

TableGroup Support_Communication_Service {
  project_reports
  notifications
  notices
  banners
  events
  team_chats_ddb
  chat_rooms_ddb
}

// --- ê´€ê³„ ì„¤ì • ---
Ref: user_stacks.user_id > users.user_id
Ref: projects.user_id > users.user_id
Ref: project_recruitment_positions.project_id > projects.project_id
Ref: applications.project_id > projects.project_id
Ref: applications.user_id > users.user_id
Ref: teams.project_id - projects.project_id
Ref: team_members.user_id > users.user_id
Ref: meeting_notes.team_id > teams.team_id
Ref: meeting_notes.user_id > users.user_id
Ref: project_reports.user_id > users.user_id
Ref: project_reports.project_id > projects.project_id
Ref: notifications.user_id > users.user_id

// [AI Service References]
// 1. í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” ìœ ì €ì™€ ì—°ê²°
Ref: test_results.user_id > users.user_id
// 2. í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” ê³µê³  ì§€ì›(Application)ê³¼ ì—°ê²° (ì„ íƒì )
Ref: test_results.application_id - applications.application_id 
// 3. í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” í”„ë¡œì íŠ¸ì™€ë„ ê°„ì ‘ ì—°ê²° ê°€ëŠ¥ (ê³µê³  ì •ë³´)
Ref: test_results.project_id > projects.project_id

// 4. íšŒì˜ ì„¸ì…˜ì€ íŒ€ì— ì¢…ì†
Ref: meeting_sessions.team_id > teams.team_id
Ref: meeting_sessions.project_id > projects.project_id
// 5. íšŒì˜ ì„¸ì…˜ì´ ëë‚˜ë©´ ìƒì„±ëœ ë¦¬í¬íŠ¸ì™€ ì—°ê²° (íšŒì˜ë¡)
Ref: meeting_sessions.generated_report_id - generated_reports.report_id

// 6. ìƒì„±ëœ ë¦¬í¬íŠ¸(íšŒì˜ë¡/ê¸°íšì„œ)ëŠ” íŒ€ê³¼ ìœ ì €(ìƒì„± ìš”ì²­ìž)ì— ì—°ê²°
Ref: generated_reports.team_id > teams.team_id
Ref: generated_reports.project_id > projects.project_id
Ref: generated_reports.created_by > users.user_id

// 7. í¬íŠ¸í´ë¦¬ì˜¤ëŠ” ìœ ì €ì™€ í•´ë‹¹ í”„ë¡œì íŠ¸ì— ì—°ê²°
Ref: portfolios.user_id > users.user_id
Ref: portfolios.project_id > projects.project_id

Ref: "applications"."position_type" < "team_members"."position_type"
